const fs = require('fs');
const AWS = require('aws-sdk');

class S3 {
    constructor(access = undefined) {
        if (access) AWS.config.update(access);
    }

    async download(key, s3Bucket, s3Region, saveAs) {
        const params = {
            Bucket: s3Bucket,
            Key: key
        }
        const s3 = new AWS.S3({region: s3Region});
        const response = await s3.getObject(params).promise();
        fs.writeFileSync(saveAs, response.Body);
    }

    async upload(key, s3Bucket, s3Region, sourceFile) {
        const readStream = fs.createReadStream(sourceFile);
        const params = {
            Bucket: s3Bucket,
            Key: key,
            Body: readStream
        }
        const s3 = new AWS.S3({region: s3Region});
        const response = await s3.putObject(params).promise();
    }
}

module.exports = S3;
