const AWS = require('aws-sdk');
class Sqs {
    constructor(access = undefined) {
        if (access) AWS.config.update(access);
    }

    async send(content, sqsUrl, sqsRegion) {
        const _sqs = new AWS.SQS({region: sqsRegion});
        const params = {
            QueueUrl: sqsUrl,
            MessageBody: content
        }
        return _sqs.sendMessage(params).promise();
    }

    async receiveMessage(sqsUrl, sqsRegion, visibilityTimeout) {
        const params = {
            QueueUrl: sqsUrl,
            VisibilityTimeout: visibilityTimeout
        }
        this.sqs = new AWS.SQS({region: sqsRegion});
        const response = await this.sqs.receiveMessage(params).promise();
        if (response.Messages) return response.Messages;
        return undefined;

    }

    deleteMessage(sqsUrl, receiptHandle) {
        const params = {QueueUrl: sqsUrl, ReceiptHandle: receiptHandle};
        return this.sqs.deleteMessage(params).promise();
    }
}

module.exports = Sqs;
